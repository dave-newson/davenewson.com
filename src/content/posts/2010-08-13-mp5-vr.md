---
layout: post
title:      "MP5 Wiimote: Virtual Reality"
subtitle:   "Modding for PC games"
date:       "2010-08-13 12:00:00"
author:     "Dave Newson"
header_img:
  url: "assets/media/posts/2010-08-13-mp5-vr/010_game1_1_.jpg"
  darken: 0.5
---

I was linked to [TheRedneckTechnie’s VR GameGun](http://www.blackhall.net/pc_vr_game_gun.htm "http://www.blackhall.net/pc_vr_game_gun.htm") (edit: now Blackhall.net, and I believe he’s selling them too), a fantastic device which consists of a screen, a gyroscopic mouse, and any first-person-shooter game.

After seeing this inspired piece of tech on YouTube I thought to myself “well, I’m half way there already...”, having alread built the MP5 Wiimote, which you can connect to any PC via Bluetooth. Whacking a screen on it and gyro mouse would indeed being you straight into the realm of virtual reality. Just thinking about immersing myself in Half-Life 2 or Crysis was enough for me to try and figure out how to do it.

Turns out, it wasn’t hard at all.

## Equipment

The RedneckTechie’s VR Gamegun used a [Gyration Air Mouse](http://www.gyration.com/index.php/gb/products/in-air-micekeyboards/air-mouse.html "http://www.gyration.com/index.php/gb/products/in-air-micekeyboards/air-mouse.html"), one of the cheapest solutions available. Luckily by the time I heard about the VR GameGun, Gyration had just released another much smaller version, the [Gyration Transport Air Mouse](http://www.gyration.com/index.php/us/support/downloads.html "http://www.gyration.com/index.php/us/support/downloads.html"), which is a much smaller Gyro mouse designed to be used on-the-go at client presentations and the like, but it uses exaclty the same gyro. My girlfriend was also nice enough to buy me one for my birthday, which I took as a green light for the rest of the project!

I’d also need a very small and light monitor, as it would go directly ontop of the gun. It would also need to be as higher resolution as possible due to its extremely close proximity to my face. Luckily, again, Samsung had just released the [Samsung U70](http://www.engadget.com/2009/02/05/samsungs-syncmaster-u70-is-7-inches-of-extra-real-estate/ "http://www.engadget.com/2009/02/05/samsungs-syncmaster-u70-is-7-inches-of-extra-real-estate/"), a tiny 7″ 800×480 resolution display, weighing in at a measly 300 grams. For £65 shipped, I couldn’t turn it down.

Conveniently I had a 30mm-scope mount already, which I could pop directly onto the Weaver rail adaptor already mounted to the gun. To attach the screen to the scope mount I figured a piece of 27mm dowel, cut to size, would work just fine; I could pad out the dowel to fit the scope mount with one half of a 25mm scope adaptor ring which came with the scope mount.

[![](/assets/media/posts/2010-08-13-mp5-vr/001_screen1_1_.jpg?w=300&tok=1c2cd6)](/assets/media/posts/2010-08-13-mp5-vr/001_screen1_1_.jpg "projects:mp5-wiimote:001_screen1_1_.jpg")

Unknown to me at the time of purchase, the U70 has a conveniently wide single-leg support on the back, which connects via a ball joint. The leg was 30mm wide by itself, perfect for mounting directly onto the dowel rod.

[![](/assets/media/posts/2010-08-13-mp5-vr/004_dowel_preview1_1_.jpg?w=300&tok=4c6b2a)](/assets/media/posts/2010-08-13-mp5-vr/004_dowel_preview1_1_.jpg "projects:mp5-wiimote:004_dowel_preview1_1_.jpg")

[![](/assets/media/posts/2010-08-13-mp5-vr/002_screen1_1_.jpg?w=300&tok=0daa67)](/assets/media/posts/2010-08-13-mp5-vr/002_screen1_1_.jpg "projects:mp5-wiimote:002_screen1_1_.jpg")

Attaching the dowel to the gun as a trial-run worked extremely well, though it looked more the most technologically advanced wizards staff ever. Attaching the monitor however wasn’t so cut-and-dry, the back leg was a good inch too long, raising the display up out of my eye level when shouldering the gun correctly.

[![](/assets/media/posts/2010-08-13-mp5-vr/000_parts1_1_.jpg?w=500&tok=e9afd9)](/assets/media/posts/2010-08-13-mp5-vr/000_parts1_1_.jpg "projects:mp5-wiimote:000_parts1_1_.jpg")



## Getting to work

First I decided to cut the dowel to the correct size. I had the most of it so I could afford to make some errors to begin with and get back into the swing of things with my Dremmel.

The first cut was perfect – almost no sanding was required to make it perfectly flat. I decided to make the mount 30 degrees off-angle, as this would allow me to tilt the screen through the widest range of angles, hopefully letting me point it perfectly towards me.

[![](/assets/media/posts/2010-08-13-mp5-vr/005_mount1_1_.jpg?w=300&tok=803b52)](/assets/media/posts/2010-08-13-mp5-vr/005_mount1_1_.jpg "projects:mp5-wiimote:005_mount1_1_.jpg")

To mount the screen, I cut off the inch-or-so of the support leg required; I bagged up the entire monitor and used beloved electrical tape to ensure plastic dust didn’t get inside the ball joint. I then made ten-or-so “ok, this time I’m going to cut it” motions towards the leg, until finally I just went for it, with the Dremmel disk slicing through it like butter. Like black, plasticy, foul-smelling butter that sends tiny curled shards of crap everywhere.

[![](/assets/media/posts/2010-08-13-mp5-vr/008_screen1_1_.jpg?w=300&tok=dee16c)](/assets/media/posts/2010-08-13-mp5-vr/008_screen1_1_.jpg "projects:mp5-wiimote:008_screen1_1_.jpg")

Once this was tidied up with a file, I marked some drill locations and put three mounting holes in the leg, then three matching holes in the dowel. I didn’t have any method to attach the leg to the dowel securely so these holes were drilled separately. This resulted in only two of the three mounting screws fitting; if I were to do it again I would use a template, or attach the two together by one scre before drilling additional holes.

To attach the gyro mouse, I had a simple plan – the mouse has a keyring “nub” sticking out one side, perfect for a 3mm bolt to fit in. I decided to cut a flat segment into the dowel sticking out the other side of the scope mount, and drilled, tapped and placed a 3mm bolt sticking out the underside. I was expecting to need to fasten the gyro mouse to the bolt with a nut of some kind, but it was held so firmly in position this wasn’t necessary!

[![](/assets/media/posts/2010-08-13-mp5-vr/006_mount1_1_.jpg?w=500&tok=6e66ae)](/assets/media/posts/2010-08-13-mp5-vr/006_mount1_1_.jpg "projects:mp5-wiimote:006_mount1_1_.jpg")

Finally the two were securely paired on the scope mount, and the VR MP5 Wiimote was ready to go!

[![](/assets/media/posts/2010-08-13-mp5-vr/009_mount1_1_.jpg?w=500&tok=0efc65)](/assets/media/posts/2010-08-13-mp5-vr/009_mount1_1_.jpg "projects:mp5-wiimote:009_mount1_1_.jpg")



## Getting it to work

To avoid difficulties with battery life and USB bridges, I decided to go with just wiring the Samsung U70 directly to the PC. A simple 10m USB cable did the job perfectly well, looped through the retractible stock to avoid snagging it and sending everything to the floor.

Unfortunately the biggest hurdle was getting Direct3D games to display on the Samsung U70; the USB connected monitor does not behave like a regular secondary screen, and cannot accept full-screen D3D, it simply freaks out and sends the full-screen back to the primary monitor.

The solution to this was the mount the Samsung U70 as a secondary monitor, like normal, but position it below the Primary monitor in the display properties. You could then start your favourite FPS game windowed, with the resolution set to a fixed 800×480 pixels (the resolution of the monitor), and carefully drag the window down onto the Samsung U70, being sure to keep the titlebar of the game on the Primary monitor.

With the game running in Windowed mode, most graphics cards don’t have a problem rending the game on the desktop, meaning it can be displayed on the U70 – it’s simply driver restrictions that prevent the U70 being used for full-screen D3D.

The gyro mouse worked almost immediately without any special intervention – the X and Y axis sensitivities needed some tweaking, but they worked with pretty much every game right of the bat.

The MP5 Wiimote was bluetooth sync’d to the PC (guides are plentiful), and then commands were mapped using [GlovePIE](http://glovepie.org/ "http://glovepie.org/"), which allows you to write scripts for interfacing the WiiMote to your PC, either with simple button presses or elaborate motion detection clauses. Besides the regular buttons (shoot, duck, etc) I added te Joystick for forward/backwards and left/right strafe (as the gyro mouse is responsible for looking left and right). I also wrote one special rule for “melee”; any significant sideways jolt to the WiiMote motion detection gyro would fire a key press I could bind to Melee Attack.



## The Virtual Reality MP5 WiiMote in action

So how cool is it? It’s very cool.

[![](/assets/media/posts/2010-08-13-mp5-vr/010_game1_1_.jpg?w=500&tok=32a54a)](/assets/media/posts/2010-08-13-mp5-vr/010_game1_1_.jpg "projects:mp5-wiimote:010_game1_1_.jpg")

I was worried that the Bluetooth Wiimote and wireless gyro mouse would suffer from significant lag, being wireless, somewhat akin to arcade gun-game latency. Surprisingly, the gyro mouse was more responsive than the IR-camera setup on the Wii itself!

I was worried about tripping over the USB cable running from the monitor to the PC, however I found that I instinctively pivoted around the muzzle of the gun, rather than turning my body on the spot, and havn’t yet tripped over the cable. I have had it wrap itself around one of my legs several times, but this actuall keeps it out the way.

The biggest issue with the gun turned out to be human error – I keep standing still in games, trying to figure out how to turn, and then I’d remember that I actually need to just, you know, turn. I had to disable strafe on the nunchuck until I get used to aiming with the gun, otherwise I would simply strafe until enemies were in my crosshair, rather than point to gun at them. It actually feels pretty natural once you stop trying to play it with a keyboard and mouse in your mind, and get used to the fact the world moves when you do, even if the edges of the screen don’t.

I also fired up Half-Life 2 and loaded my last save – this happened to be at the end of the coastal driving section, where there’s a little lighthouse. After getting shot up pretty badly I decided to retreat into the lighthouse and take cover upstairs – but by the time I finished running up the steps I was so dizzy I had to sit down for a moment! I bet that’s something the designers never had to consider.



## Future Improvements

Had it been available at the time, I would have preferred to use the Wii Motion Plus adaptor, plugged into the WiiMote. This would have meant less accessories and the whole thing could work off the WiiMote GlovePIE interface.

Additionally the Gyro mouse isn’t designed for this purpose; when you aim very far up or down, the left/right motion of the gyro is less than when pointing the gun directly forward, reducing the apparent sensitivity of the gun at these extreme angles. If one were able to use the scripting of GlovePIE coupled with the values of th Wii Motion Plus gyros, you could program a multiplier to increase the horizontal sensitivity depending on the vertical angle of the gun. Alas, this cannot be done with the gyro mouse alone, so periodically you need to “re-center” the gun to ensure you’re facing the way you think you are.

Totally worth it.